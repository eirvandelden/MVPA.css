# Local lefthook configuration for mvpa.css gem
# Extends the global lefthook.yml from dotfiles

pre-commit:
  commands:
    update-gem-version:
      priority: 0
      glob: "*"
      run: |
        SHA=$(git rev-parse --short HEAD)
        VERSION="0.1.0-git.${SHA}"
        echo "module Mvpa" > lib/mvpa/css/version.rb
        echo "  module Css" >> lib/mvpa/css/version.rb
        echo "    VERSION = \"$VERSION\"" >> lib/mvpa/css/version.rb
        echo "  end" >> lib/mvpa/css/version.rb
        echo "end" >> lib/mvpa/css/version.rb
        git add lib/mvpa/css/version.rb
        echo "âœ… Gem version will be $VERSION"
      fail_text: Failed to update gem version file

pre-push:
  skip:
    - bundle-audit
    - brakeman
    - minitest
    - rspec
